# INCEPTION PROJECTMandatory part

This project involves setting up a small infrastructure composed of different services under specific rules. The whole project has to be done in a virtual machine. You must use

## ğŸ¯ Mandatory PartDocker Compose.

Each Docker image must have the same name as its corresponding service.

### Project OverviewEach service has to run in a dedicated container.

This project involves setting up a small infrastructure composed of different services under specific rules. For performance reasons, the containers must be built from either the penultimate stable

The whole project has to be done in a virtual machine using **Docker Compose**.version of Alpine or Debian. The choice is yours.

You also have to write your own Dockerfiles, one per service. The Dockerfiles must

### ğŸ“‹ General Requirementsbe called in your docker-compose.yml by your Makefile.

- Each Docker image must have the same name as its corresponding serviceThis means you must build the Docker images for your project yourself. It is then forbidden to pull ready-made Docker images or use services such as DockerHub (Alpine/Debian

- Each service must run in a dedicated containerbeing excluded from this rule).

- Containers must be built from either the penultimate stable version of **Alpine** or **Debian**You then have to set up:

- You must write your own Dockerfiles, one per serviceâ€¢ A Docker container that contains NGINX with TLSv1.2 or TLSv1.3 only.

- Dockerfiles must be called in your docker-compose.yml by your Makefileâ€¢ A Docker container that contains WordPress with php-fpm (it must be installed

- **Forbidden**: Pull ready-made Docker images or use services such as DockerHub (except Alpine/Debian)and configured) only, without nginx.

â€¢ A Docker container that contains only MariaDB, without nginx.

### ğŸ³ Required Servicesâ€¢ A volume that contains your WordPress database.

- **NGINX Container**: Contains NGINX with TLSv1.2 or TLSv1.3 onlyâ€¢ A second volume that contains your WordPress website files.

- **WordPress Container**: Contains WordPress with php-fpm (installed and configured), without nginxâ€¢ A docker-network that establishes the connection between your containers.

- **MariaDB Container**: Contains only MariaDB, without nginxYour containers must restart automatically in case of a crash.

- **Volume 1**: Contains your WordPress databaseA Docker container is not a virtual machine. Thus, it is not

- **Volume 2**: Contains your WordPress website files  recommended to use any hacky patches based on â€™tail -fâ€™ and similar

- **Docker Network**: Establishes connection between containersmethods when trying to run it. Read about how daemons work and

whether itâ€™s a good idea to use them or not.

### âš ï¸ Important Rules7

Inception

âœ… **Required:**Of course, using network: host or --link or links: is forbidden.

- Containers must restart automatically in case of a crashThe network line must be present in your docker-compose.yml file.

- Network line must be present in docker-compose.ymlYour containers must not be started with a command running an

- Two users in WordPress database (one admin, username must NOT contain 'admin', 'Admin', 'administrator', 'Administrator')infinite loop. Thus, this also applies to any command used as

- Volumes available in `/home/login/data` folder on host machineentrypoint, or used in entrypoint scripts. The following are a

- Domain name must be `login.42.fr` (replace with your login)few prohibited hacky patches: tail -f, bash, sleep infinity, while

- Use environment variables (.env file recommended)true.

- Use Docker secrets for confidential informationRead about PID 1 and the best practices for writing Dockerfiles.

â€¢ In your WordPress database, there must be two users, one of them being the administrator. The administratorâ€™s username must not contain â€™adminâ€™, â€™Adminâ€™, â€™administratorâ€™, or â€™Administratorâ€™ (e.g., admin, administrator, Administrator, admin-123,

âŒ **Forbidden:**etc.).

- Using `network: host` or `--link` or `links:`Your volumes will be available in the /home/login/data folder of the

- Commands running infinite loops (`tail -f`, `bash`, `sleep infinity`, `while true`)host machine using Docker. Of course, you have to replace the login

- Hacky patches for entrypointswith yours.

- Latest tagTo simplify the process, you must configure your domain name to point to your local

- Passwords in DockerfilesIP address.

This domain name must be login.42.fr. Again, you must use your own login.

ğŸ’¡ **Best Practices:**For example, if your login is â€™wilâ€™, wil.42.fr will redirect to the IP address pointing to

- Read about PID 1 and best practices for writing DockerfilesWilâ€™s website.

- Understand how daemons workThe latest tag is prohibited.

- NGINX container must be the sole entry point (port 443, TLSv1.2 or TLSv1.3)Passwords must not be present in your Dockerfiles.

The use of environment variables is mandatory.

### ğŸ“ Expected Directory StructureIt is also strongly recommended to use a .env file to store

```environment variables and to use the Docker secrets to store any

inception/confidential information.

â”œâ”€â”€ MakefileYour NGINX container must be the sole entry point into your

â”œâ”€â”€ secrets/infrastructure, accessible only via port 443, using the TLSv1.2

â”‚   â”œâ”€â”€ credentials.txtor TLSv1.3 protocol.

â”‚   â”œâ”€â”€ db_password.txt8

â”‚   â””â”€â”€ db_root_password.txtInception

â””â”€â”€ srcs/Here is an example diagram of the expected result:

    â”œâ”€â”€ docker-compose.yml9

    â”œâ”€â”€ .envInception

    â””â”€â”€ requirements/Below is an example of the expected directory structure:

        â”œâ”€â”€ bonus/$> ls -alR

        â”œâ”€â”€ mariadb/total XX

        â”‚   â”œâ”€â”€ conf/drwxrwxr-x 3 wil wil 4096 avril 42 20:42 .

        â”‚   â”œâ”€â”€ Dockerfiledrwxrwxrwt 17 wil wil 4096 avril 42 20:42 ..

        â”‚   â”œâ”€â”€ .dockerignore-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 Makefile

        â”‚   â””â”€â”€ tools/drwxrwxr-x 3 wil wil 4096 avril 42 20:42 secrets

        â”œâ”€â”€ nginx/drwxrwxr-x 3 wil wil 4096 avril 42 20:42 srcs

        â”‚   â”œâ”€â”€ conf/./secrets:

        â”‚   â”œâ”€â”€ Dockerfiletotal XX

        â”‚   â”œâ”€â”€ .dockerignoredrwxrwxr-x 2 wil wil 4096 avril 42 20:42 .

        â”‚   â””â”€â”€ tools/drwxrwxr-x 6 wil wil 4096 avril 42 20:42 ..

        â””â”€â”€ wordpress/-rw-r--r-- 1 wil wil XXXX avril 42 20:42 credentials.txt

            â”œâ”€â”€ conf/-rw-r--r-- 1 wil wil XXXX avril 42 20:42 db_password.txt

            â”œâ”€â”€ Dockerfile-rw-r--r-- 1 wil wil XXXX avril 42 20:42 db_root_password.txt

            â”œâ”€â”€ .dockerignore./srcs:

            â””â”€â”€ tools/total XX

```drwxrwxr-x 3 wil wil 4096 avril 42 20:42 .

drwxrwxr-x 3 wil wil 4096 avril 42 20:42 ..

### ğŸ” Security Requirements-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 docker-compose.yml

- Any credentials, API keys, passwords must be saved locally and ignored by git-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 .env

- Publicly stored credentials will lead to project failuredrwxrwxr-x 5 wil wil 4096 avril 42 20:42 requirements

- Use .env file for environment variables./srcs/requirements:

- Use Docker secrets for sensitive datatotal XX

drwxrwxr-x 5 wil wil 4096 avril 42 20:42 .

---drwxrwxr-x 3 wil wil 4096 avril 42 20:42 ..

drwxrwxr-x 4 wil wil 4096 avril 42 20:42 bonus

## ğŸŒŸ Bonus Partdrwxrwxr-x 4 wil wil 4096 avril 42 20:42 mariadb

drwxrwxr-x 4 wil wil 4096 avril 42 20:42 nginx

### Overviewdrwxrwxr-x 4 wil wil 4096 avril 42 20:42 tools

The bonus part is intended to be simple. A Dockerfile must be written for each additional service.drwxrwxr-x 4 wil wil 4096 avril 42 20:42 wordpress

Each service will run inside its own container with dedicated volumes if necessary../srcs/requirements/mariadb:

total XX

### ğŸ“ Bonus Services Listdrwxrwxr-x 4 wil wil 4096 avril 42 20:45 .

- **Redis Cache**: Set up redis cache for WordPress website cache managementdrwxrwxr-x 5 wil wil 4096 avril 42 20:42 ..

- **FTP Server**: Container pointing to WordPress website volumedrwxrwxr-x 2 wil wil 4096 avril 42 20:42 conf

- **Static Website**: Simple static website (any language except PHP)-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 Dockerfile

- **Adminer**: Database administration tool-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 .dockerignore

- **Custom Service**: Service of your choice (must justify during defense)drwxrwxr-x 2 wil wil 4096 avril 42 20:42 tools

[...]

### ğŸ“ Bonus Rules./srcs/requirements/nginx:

- Extra services may open more ports as neededtotal XX

- Bonus will only be assessed if mandatory part is **perfect**drwxrwxr-x 4 wil wil 4096 avril 42 20:42 .

- Perfect means: fully completed and functions without any malfunctionsdrwxrwxr-x 5 wil wil 4096 avril 42 20:42 ..

- If ANY mandatory requirement is not passed, bonus will NOT be evaluateddrwxrwxr-x 2 wil wil 4096 avril 42 20:42 conf

-rw-rw-r-- 1 wil wil XXXX avril 42 20:42 Dockerfile

----rw-rw-r-- 1 wil wil XXXX avril 42 20:42 .dockerignore

drwxrwxr-x 2 wil wil 4096 avril 42 20:42 tools

## ğŸš€ Quick Start Commands[...]

```bash$> cat srcs/.env

# Build and start all servicesDOMAIN_NAME=wil.42.fr

make all# MYSQL SETUP

MYSQL_USER=XXXXXXXXXXXX

# Start services only[...]

make up$>

For obvious security reasons, any credentials, API keys, passwords,

# Stop all servicesetc., must be saved locally in various ways / files and ignored by

make downgit. Publicly stored credentials will lead you directly to a failure

of the project.

# Full cleanup10

make fcleanInception

You can store your variables (as a domain name) in an environment

# Rebuild everythingvariable file like .env

make re11

Chapter VI

# Bonus servicesBonus part

make bonusFor this project, the bonus part is intended to be simple.

```A Dockerfile must be written for each additional service. Thus, each service will run

inside its own container and will have, if necessary, its dedicated volume.

## ğŸŒ Access PointsBonus list:

- **Main Site**: https://localhost:443â€¢ Set up redis cache for your WordPress website in order to properly manage the

- **Portfolio** (bonus): http://localhost:3000cache.

- **Adminer** (bonus): http://localhost:8080â€¢ Set up a FTP server container pointing to the volume of your WordPress website.

- **Monitoring** (bonus): http://localhost:19999â€¢ Create a simple static website in the language of your choice except PHP (yes, PHP

- **Redis** (bonus): localhost:6379is excluded). For example, a showcase site or a site for presenting your resume.

- **FTP** (bonus): ftp://localhost:21â€¢ Set up Adminer.

â€¢ Set up a service of your choice that you think is useful. During the defense, you

---will have to justify your choice.

To complete the bonus part, you have the possibility to set up extra

## ğŸ“ Notes for Current Implementationservices. In this case, you may open more ports to suit your needs.

The bonus part will only be assessed if the mandatory part is

### âœ… What's Already Donecompleted perfectly. Perfect means the mandatory part has been

- âœ… Makefile with all required targetsfully completed and functions without any malfunctions. If you have

- âœ… Docker Compose configuration (mandatory + bonus)not passed ALL the mandatory requirements, your bonus part will not

- âœ… Environment variables (.env file)be evaluated at all.
- âœ… Docker secrets (credentials, passwords)
- âœ… Volume directories setup
- âœ… All required Dockerfiles
- âœ… Network configuration
- âœ… Bonus services (Redis, FTP, Portfolio, Adminer, Monitoring)

### ğŸ”§ Current Issue
- ğŸ”´ **Database Connection Error**: MariaDB script needs fixing
- ğŸ”´ **Image Build Issue**: Docker pulling official images instead of building custom ones

### ğŸ¯ Next Steps
1. Fix MariaDB initialization script
2. Force rebuild of custom Docker images
3. Test database connectivity
4. Verify WordPress connection to database